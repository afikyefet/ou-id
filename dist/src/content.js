(function(){"use strict";function w(e){if(!e||e.nodeType!==1)return null;const i=e.tagName.toLowerCase(),n=[],s=e.getAttribute("id");s&&!/\d{3,}/.test(s)&&n.push(`#${CSS.escape(s)}`);const a=e.getAttribute("name");a&&n.push(`[name="${CSS.escape(a)}"]`);const u=e.getAttribute("data-testid");u&&n.push(`[data-testid="${CSS.escape(u)}"]`);const d=e.getAttribute("role");if(d&&n.push(`[role="${CSS.escape(d)}"]`),n.length)return`${i}${n.join("")}`;const c=[];let t=e;for(;t&&t.nodeType===1&&c.length<5;){let r=t.tagName.toLowerCase();const o=(t.getAttribute("class")||"").split(/\s+/).filter(l=>l&&!/\d{3,}/.test(l)&&l.length<40).slice(0,2);o.length&&(r+="."+o.map(l=>CSS.escape(l)).join("."));const h=t.parentElement;if(h){const l=Array.from(h.children).filter(S=>S.tagName===t.tagName);l.length>1&&(r+=`:nth-of-type(${l.indexOf(t)+1})`)}c.unshift(r),t=h}return c.join(" > ")}function m(e){var s;if(!e)return null;const i=e.tagName.toLowerCase(),n=(e.getAttribute("type")||"").toLowerCase();return i==="select"?e.value??"":i==="input"||i==="textarea"?n==="checkbox"?e.checked?"true":"false":n==="radio"?e.checked?e.value:"":e.value??"":e.isContentEditable?e.innerText:((s=e.textContent)==null?void 0:s.trim())??""}function p(e,i){if(!e)return!1;const n=e.tagName.toLowerCase(),s=(e.getAttribute("type")||"").toLowerCase();if(n==="select")return e.value=i??"",e.dispatchEvent(new Event("change",{bubbles:!0})),!0;if(n==="input"||n==="textarea"){if(s==="checkbox")e.checked=i===!0||String(i).toLowerCase()==="true";else if(s==="radio"){const a=e.getAttribute("name");if(a){const u=document.querySelectorAll(`input[type="radio"][name="${CSS.escape(a)}"]`);for(const d of u)d.checked=String(d.value)===String(i)}else String(e.value)===String(i)&&(e.checked=!0)}else e.value=i??"";return e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),!0}if(e.isContentEditable)return e.innerText=i??"",e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),!0;try{return e.textContent=i??"",!0}catch{return!1}}function b(e){try{const i=document.querySelector(e);if(i)return i}catch{}try{const i=document.querySelectorAll("*");for(const n of i)if(n.shadowRoot){const s=n.shadowRoot.querySelector(e);if(s)return s}}catch{}return null}chrome.runtime.onMessage.addListener((e,i,n)=>{if(e.type==="PING")n({pong:!0});else if(e.type==="RESOLVE_ELEMENT_AND_VALUE"){const{selector:s}=e.payload,a=b(s),u=m(a);n({ok:!!a,value:u,present:!!a})}else if(e.type==="PASTE_PROFILE_MAPPINGS"){const{mappings:s}=e.payload,a=[];for(const u of s){const d=b(u.selector),c=p(d,u.value);a.push({selector:u.selector,ok:c,found:!!d})}n({ok:a.every(u=>u.ok),results:a})}return!0});function y(e){var h;if(!e||e.nodeType!==1)return null;const i=e.tagName.toLowerCase(),n=(e.getAttribute("type")||"").toLowerCase(),s=e.getAttribute("id")||"",a=e.getAttribute("name")||"",u=e.getAttribute("placeholder")||"",d=e.getAttribute("aria-label")||"";(h=e.className)!=null&&h.toString();const c=m(e)||"";let t="element",r="",o="low";return i==="input"?n==="email"?(t="email",r="Email field",o="high"):n==="password"?(t="password",r="Password field",o="high"):n==="text"?/name|first|last/i.test(a+s+u+d)?(t="name",r="Name field",o="high"):/address|street|city|zip/i.test(a+s+u+d)?(t="address",r="Address field",o="high"):/phone|mobile|tel/i.test(a+s+u+d)?(t="phone",r="Phone field",o="high"):(t="text",r="Text input",o="medium"):n==="number"?(t="number",r="Number field",o="high"):n==="checkbox"?(t="checkbox",r="Checkbox",o="high"):n==="radio"?(t="radio",r="Radio button",o="high"):n==="submit"&&(t="button",r="Submit button",o="high"):i==="select"?(t="select",r="Dropdown",o="high"):i==="textarea"?(t="textarea",r="Text area",o="high"):i==="button"?(t="button",r="Button",o="high"):i==="a"?(t="link",r="Link",o="medium"):/h[1-6]/.test(i)?(t="heading",r="Heading",o="medium"):e.isContentEditable&&(t="contenteditable",r="Editable content",o="high"),c&&(c.includes("@")&&c.includes(".")?(t="email",r="Email address",o="high"):/^\d+$/.test(c)?(t="number",r="Number",o="medium"):/^\$[\d,]+(\.\d{2})?$/.test(c)?(t="price",r="Price",o="high"):/\d{4}-\d{2}-\d{2}/.test(c)&&(t="date",r="Date",o="high")),{category:t,purpose:r,confidence:o,value:c.substring(0,50),hasValue:!!c}}let E=location.href,g=Date.now();function f(){chrome.runtime.sendMessage({type:"PAGE_CHANGED",payload:{url:location.href,timestamp:Date.now(),loadTime:g}}).catch(()=>{})}new MutationObserver(()=>{location.href!==E&&(E=location.href,g=Date.now(),setTimeout(f,1e3))}).observe(document,{subtree:!0,childList:!0}),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{setTimeout(f,500)}):setTimeout(f,500),window.addEventListener("popstate",()=>{g=Date.now(),setTimeout(f,1e3)}),window.addEventListener("hashchange",()=>{setTimeout(f,500)}),window.__ES_UTILS__={robustSelector:w,getElementValue:m,setElementValue:p,analyzeElement:y}})();
